---
title: "The Effects of Multiple Variables on Traffic Fatalities"
output:
  pdf_document: default
  html_document:
    df_print: paged
    fig_caption: yes
    number_sections: yes
---

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```

# Introduction



## Background

In 2018, there are *36,560* people died in highway motor vehicle crashes in the United States, or a little more than 12 for every 100,000 people. To put that in perspective, 39,260 women died from breast cancer and 29,720 men died from prostate cancer in 2013, according to the American Cancer Society[^1]. In fact, traffic fatalities are the third-leading cause of death due to injury (non-health and disease related) in the U.S. However, there is a lack of public awareness of the death.

The dataset we are going to analyze today is from the R package 'AER' named `Fatalities`, which contains the information about the traffic fatalities data for 48 US states annually from 1982 to 1988. This dataset was generated by the US Department of Transportation Fatal Accident Reporting System.

## Statistical questions of interest


We want to investigate the impact of the mandatory jail sentence and a variety of alcohol-control policies on motor vehicle fatality rates, using fixed- effect models with data for the 48 contiguous states over the 1982 through 1988 time period. We'll also combine independent estimates in random-effects models to obtain aggregate effect estimates.
The fatality will be influenced by not only the mandatory jail sentence, but also other factors, such as income, tax on the beer, time, population, etc. Our goal is to examine the relationship between the mandatory jail sentence, which is the main independent variable, and the fatality, which is the main dependent variable.



# Analysis Plan


Since the dataset is a balanced panel one, we will use *plm()*, an `R` function from package `'plm'` which enables us to estimate linear panel regression models. Considering that the fixed effects model can be generalized to contain more than just one determinant, we will use the fixed effect model first.  In this report, we mainly focus on the fixed effect model. However, some categorical variable is subjects. In this case, the 'group' effect is best thought of as random because we only sample a subset of the entire population of subjects. So we will perform random effect models after that and compare with each other to determine which model shows better performance or consider a mixed model.


# Statistical Analysis


## Descriptive Analysis

```{R include=FALSE}
library(AER)
library(plm)
data(Fatalities)

dim(Fatalities) # Obtain the dimension
str(Fatalities) # Inspect the structure

summary(Fatalities[, c(1, 2,17)]) # Summarize the variables 'state' and 'year'

d <- Fatalities
d1 <- d[,-c(18:26)]
d1 = d1[,-c(19:21)]
d1 <- d1[-28,]
summary(d1[, c(1, 2,17,15)])
```


| Variable | Year | State | Fatality          | Jail |
|----------|------|-------|-------------------|------|
| Level    | 7    | 48    | (Not Catagorical) | 2    |

<div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">Table 1: The summary table of factor 'State'.
</div>

There are four variables particularly of interest: year state jail and fatality. We check the Heterogeniety across the level of both state and year.

```{r,warning=FALSE,echo=FALSE,include=FALSE}
library(tidyverse)  # Modern data science library 
library(plm)       # Panel data analysis library
library(car)       # Companion to applied regression 
library(gplots)    # Various programing tools for plotting data
library(tseries)   # For timeseries analysis
library(lmtest) # For hetoroskedasticity analysis

```
```{r,echo=FALSE,warning=FALSE}
plotmeans(fatal ~ year, data = d1,main = 'Heterogeneity across years')
```
<div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">Figure 1: The mean plot of variable 'Year' to determine its Heterogeniety.
</div>
```{r,echo=FALSE,warning=FALSE}
plotmeans(fatal ~ state, data = d1,main = 'Heterogeneity across states')
```
<div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">Figure 2: The mean plot of variable 'State' to determine its Heterogeniety.
</div>

As we observe from the graphs(Figure 1 & 2), the fatality varies slightly across the years while the fluactuation is significant across the states. *For policymakers*, it is important to investigate the reason what are the causes leading to this state-wide fatality differences.The focus should be those kinds of variables change rapidly across state while not across years.   


# Analysis Using Fixed Effect Model

## Fixed Effect Model 

Then we will use fixed effect model. 

Each state has its own individual characteristics that may or may not influence the determination of jail sentence, the predictors. Fixed effect model removes the effect of  time-invariant characteristics so we can assess the net effect of the jail sentence on the outcome, the fatality. This model can significantly reduce the omitted variable bias, which is the bias caused by other variables that are correlated with the fatality rate.


The model is:

$$Y_{it}=\mu+\beta X_{it}+\alpha_i+\epsilon_{it}$$,

with $i=1,\ldots,n$ and $t=1,\ldots,T$, in which $n$ is the total sample size and $T$ is the length of time interval. $X$ is the mandatory jail sentence, and $Y$ is the fatality rate after appropriate transformation. $\alpha_i$ is determined by the effect of state and the effect of time, since it is reasonable to assume that apart from the jail sentence, state and time are two main factors that can affect the fatality rate. We assume that the effect of other factors are fixed. 

## Assumptions

1, Normality: residuals we assume that $\epsilon_{ijk}$ follows a normal distribution with zero mean.

2, Constant Variance: across different levels the variance should be a constant.

3, Independent sampling: The sample should be independently sampled from there joint distribution.

## Model fitting and some results

```{r,echo=FALSE,include=FALSE}
plm_output <- plm(fatal ~ jail, data = d1,index = c("state", "year"), model = "within",effect = "twoways")
coeftest(plm_output, vcov = vcovHC, type = "HC1")
```

The following table shows the result of the analysis using the fixed effect model.

```
          Estimate  Std. Error  t value  Pr(>|t|)
jail      0.45451   35.79380    0.0127    0.9899
```

From the above table, we observe that the p value are not small, therefore the relationship between the mandatory jail sentence and the fatality rate is unclear. 

## Model Diagnostic Analysis

### Normality checking

```{r ,echo=FALSE}
qqnorm(residuals(plm_output), ylab = 'Residuals')
qqline(residuals(plm_output))

```
<div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">Figure 3: The Q-Q plot of residuals to determine its normality.
</div>

The Figure 3 shows the the distribution of fatal is approximately normally, while the tails are heavier. 

### Constant Variance:

```{r,echo=FALSE}
plot(d1$fatal,residuals(plm_output))
abline(0, 0)
```
<div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">Figure 4: The scatter plot of residuals to determine the constant variance.
</div>

From Figure 4 we could draw the conclusion that constant variance assumptions are violated since large values tends to have a larger variance.


# Hypothesis Testing and Confidence Interval

The hypothesis testing problem can be stated as following:

$$H_0: \beta=0 \quad vs \quad H_a: \beta\neq 0$$.

| Estimated Value | Test Statistics | P-value | Confidence Interval | Decision Rule   |
|-----------------|-----------------|---------|---------------------|-----------------|
| 0.45450592      | 0.01269789      | 0.989   | [-0.0009,0.901]      | Fail to Reject the null |
<div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">Table 2: Hypothesis testing results.
</div>
From the above table, we observe that the p value are not significant, therefore the relationship between the mandatory jail sentence and the fatality rate is unclear.

Furthermore we construct the confidence interval, while 0 is included. We can not conclude that the effect of jail sentence is significant.

```{r,include=FALSE}

coeftest(plm_output, vcov = vcovHC, type = "HC1")[1, ]

```




# Summary and Suggestions for policymakers

We summarize our findings as following.

(1) We have not found proof that the existance of mandatory jail sentence does reduce traffic fatalities due to drunk driving.The correlation unclear, since the p value shows that the effect of our predictor is not significant.

(2) The causal inference can not be maded from this model. In this model, there may be some omitted variables that differ across states and do change over time. Even though we use a panel approach equipped with fixed effect model, the extra bias caused by other omitted variable may not be negligible.

For policymakers: 

More measurements should be taken into account for sure. We should consider more factors that tend to change with time and show more fluactuations across years. At this point, the effect of existance of mandatory jail sentence remains unclear, and we can not rule it out as a method to prevent future accident. Once more measurements are collected and the same fixed effect model could be more precise by including more omitted variables. 






